#!/bin/bash
function mountbackup {
    mount /mnt/backup
    mount /mnt/backup/usr
    mount /mnt/backup/boot
    mount /mnt/backup/var
    mount /mnt/backup/opt
    mount /mnt/backup/home
    mount /mnt/backup/tmp
}

function umountbackup {
    umount /mnt/backup/usr
    umount /mnt/backup/boot
    umount /mnt/backup/var
    umount /mnt/backup/opt
    umount /mnt/backup/home
    umount /mnt/backup/tmp
    umount /mnt/backup
}

function syncbackup {
    
    rsync -ai --progress --delete --exclude-from=/home/scriper/bin/exclude / /mnt/backup/
    rsync -ai --progress --delete /home /mnt/backup/home
    rsync -ai --progress --delete /usr /mnt/backup/usr
    rsync -ai --progress --delete /var /mnt/backup/var
    rsync -ai --progress --delete /opt /mnt/backup/opt
    rsync -ai --progress --delete /boot /mnt/backup/boot
}
echo 'mounting /boot'
mount /boot
echo 'mounting backup'
mountbackup
echo 'synchronithing...'
syncbackup
echo 'finished!'
echo 'unmouting'
umount /boot
umountbackup
